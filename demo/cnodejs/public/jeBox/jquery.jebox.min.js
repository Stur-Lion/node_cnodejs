/**
 @Name : jeBox v1.6 弹层组件
 @Author: chen guojun
 @Date: 2017-09-29
 @QQ群：516754269
 @官网：http://www.jemui.com/jebox/ 或 https://github.com/singod/jeBox
 */
!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof module&&"object"==typeof module.exports?module.exports=b():a.jeBox=b()}(this,function(){var h,a={endfun:{}},b=/\px|em/g,c=-[1]?9:parseInt(navigator.appVersion.split(";")[1].replace(/MSIE|[ ]/g,"")),d=["jeBox",".jeBox-wrap",".jeBox-header",".jeBox-content",".jeBox-footer",".jeBox-close",".jeBox-maxbtn"],e=Math.floor(9e3*Math.random()),f=function(a){var b=this,c={cell:"",title:"提示信息",content:"暂无内容！",boxStyle:{},closeBtn:!0,closefun:null,maxBtn:!1,boxSize:["auto","auto"],padding:"5px",offset:["auto","auto"],type:"dialog",icon:0,button:[],btnAlign:"right",time:0,maskLock:!0,maskClose:!0,maskColor:["#000",.5],isDrag:!0,fixed:!0,zIndex:9999,scrollbar:!1,shadow:!0,success:null,endfun:null};b.config=$.extend({},c,a),b.jeidx=""==b.config.cell||void 0==b.config.cell?++e:b.config.cell.replace(/[#.]/,""),b.initView()},g=f.prototype;return g.initView=function(){var n,o,p,q,t,u,v,w,r,s,x,y,z,b=this,c=b.config,e=b.jeidx,f=c.content,g=c.type,i=c.icon,j=["dialog","iframe","loading","tips"],k="object"==typeof f,l=f[0]&&1===f[0].nodeType,m='<div class="jeBox-iconbox jeicon'+i+'">'+f+"</div>";if(a.scrollbar=c.scrollbar,!c.cell||!$("#"+d[0]+b.jeidx)[0]){switch(g){case j[0]:c.type=j[0],"string"==typeof f?c.content=0!==i?m:f:l&&(c.content="",a["dispy"+e]=f.css("display"),a["prev"+e]=f.prev(),a["next"+e]=f.next(),a["parent"+e]=f.parent(),"none"==f.css("display")&&f.css("display","block")),h.closeAll(j[0]);break;case j[1]:c.type=j[1],n=k?f:[f||"http://www.jemui.com/","auto"],c.content='<iframe scrolling="'+(n[1]||"auto")+'" allowtransparency="true" id="jeboxiframe'+e+'" name="'+e+'" onload="this.className=\'\';" frameborder="0" width="100%" height="100%" src="'+n[0]+'"></iframe>',h.closeAll(j[1]);break;case j[2]:c.type=j[2],c.content='<div class="jeBox-loadbox jeload'+i+'">'+f+"</div>",h.closeAll(j[2]);break;case j[3]:c.type=j[3],h.closeAll(j[3])}if(c.type==j[3]){switch(o=$.isArray(c.boxSize)?c.boxSize[0]:c.boxSize,p=$.isArray(c.boxSize)?c.boxSize[1]:c.boxSize,q=$("<div>",{"class":"jeBox-tips",id:d[0]+e}).css({width:o,height:p,"z-index":c.zIndex}).css(c.boxStyle),$("body").append(q.append("<em></em><div class='jeBox-tipscon'>"+c.content+"</div>")),r=$(c.cell).offset().top,s=$(c.cell).offset().left,x=c.spacing,y=$(c.cell).outerHeight(),z=$(c.cell).outerWidth(),p=q.outerHeight(!0),o=q.outerWidth(!0),c.align){case"top":case"bottom":w="top"==c.align?"bottom":"top",v="border-right-color",u=s,t="top"==c.align?r-p-x:r+y+x;break;case"left":case"right":w="left"==c.align?"right":"left",v="border-bottom-color",t=r,u="left"==c.align?s-o-x:s+z+x}q.css({top:t,left:u}),q.find("em").css(v,q.css("background-color")).css(w,-8),q.attr("jetype",c.type),b.btnCallback(q)}else b.creatBox(function(a){if(l&&(a.attr("jenode",f.selector.toString()),a.find(d[3]).append(f)),a.attr("jetype",c.type),b.btnCallback(a),c.isDrag){var e=a,g=a.find(d[2]);b.dragLayer(e,g,.4,c.shadow)}b.setSize(a),b.setPosition(a)})}},g.creatBox=function(b){var t,u,v,w,x,e=this,f=e.config,g=e.jeidx,i=f.button,j=i.length,k=function(){var a=0!=j?function(){var a=[];return $.each(i,function(b,c){a.push('<button type="button" class="jeBox-btn'+b+'" jebtn="'+b+'" '+(1==c.disabled?"disabled":"")+">"+c.name+"</button>")}),a.join("")}():"";return'<div class="jeBox-footer">'+a+"</div>"}(),l=f.padding,m=f.skinCell||"jeBox-anim",n='<span class="jeBox-headbtn"><a href="javascript:;" class="jeBox-maxbtn" title="最大化"></a><a href="javascript:;" class="jeBox-close" title="&#20851;&#38381;"></a></span><div class="jeBox-header"></div><div class="jeBox-content" style="padding:'+(""!=l?l:0)+';">'+f.content+"</div>"+k,o=function(a){var b=0;return a.each(function(){b=Math.max(b,$(this).css("z-index"))}),b},p=f.zIndex,q=$(d[1]).size()>0?o($(d[1]))+5:p+5,r=$(d[1]).size()>0?o($(d[1]))+2:p,s=$("<div/>",{id:d[0]+g,"class":d[1].replace(/\./g,"")});$("body").append(s.append(n)),s.attr("jeitem",g),s.css({position:f.fixed?"fixed":"absolute","z-index":q}),parseInt(c)<9?s.addClass("jeBox-ies"):s.addClass(m),h.zIndex=parseInt(s.css("z-index")),!a.scrollbar&&$("body").css("overflow","hidden"),f.maskLock&&(t=$("<div/>",{id:"jemask"+g,"class":"jeBox-mask"}),u=f.maskColor,$("body").append(t),t.css({left:0,top:0,"background-color":u[0],"z-index":r,opacity:u[1],filter:"alpha(opacity="+100*u[1]+")"})),v=0==f.title?"":f.title||config.title,w="object"==typeof v,x=v?w?v[0]:v:"",s.find(d[2]).html(x).css({display:""!=x?"":"none",height:""!=x?"":"0px"}).css(w?v[1]:{}),s.find(d[4]).css({display:0!=j?"block":"none","text-align":f.btnAlign}),s.find(d[5]).css("display",f.closeBtn?"":"none"),s.find(d[6]).css("display",f.maxBtn?"":"none"),b&&b(s)},g.setSize=function(c){var g,h,i,j,w,x,y,z,A,B,e=this,f=e.config,k=c.find(d[3]),l=f.boxSize,m=function(a){return parseInt(k.css(a).replace(b,""))},n=a.conhead=c.find(d[2]).height(),o=a.confoot=c.find(d[4]).height(),p=$(window).width(),q=$(window).height(),r=m("padding-top")+m("padding-bottom"),s=m("padding-left")+m("padding-right"),t=m("margin-top")+m("margin-bottom"),u=m("margin-left")+m("margin-right"),v=function(a,c){return/^\d+%$/.test(c.toString())?parseInt(a*(c.toString().replace("%","")/100)):parseInt(c.toString().replace(b,""))};$.isArray(l)&&(w=l[0],x=l[1],y=v(p,w),z=v(q,x),A=y>=p?p:y,B=z>=q?q:z,"number"===$.type(w)?(g=y+s+u,i=y):"auto"==w?(i=c.width(),g=i+s+u):(g=A,i=A-s-u),"number"===$.type(x)?(h=z+r+t,j=z-n-o):"auto"==x?(h=c.height(),j=h-t-n-o):(h=B,j=B-t-n-o)),f.maxBtn&&c.attr("area",[g,h,i,j]),c.css({width:g,height:h}).css(f.boxStyle),c.find(d[3]).css({height:j})},g.setPosition=function(a){var e,f,g,c=this,d=c.config,h=d.offset,i=$.isArray(h),j=a.width(),k=a.height(),e=h[0],l=h[1],m=$(window).width(),n=$(window).height();f=i&&/^\@/.test(e)?e.replace(/\@/g,""):"auto"==e?(n-k)/2:/^\d+%$/.test(e)?e:e.replace(b,""),g=i&&/^\@/.test(l)?l.replace(/\@/g,""):"auto"==l?(m-j)/2:/^\d+%$/.test(l)?l:l.replace(b,""),a.css(i&&(/^\@/.test(e)||/^\@/.test(l))?{right:f,bottom:g}:{top:f,left:g}),d.maxBtn&&a.attr("offset",[f,g])},g.btnCallback=function(b){var c=this,e=c.config,f=c.jeidx,g=b.find(d[6]),i=e.time,j=e.button,k=e.offset;e.success&&("iframe"==e.type?b.find("iframe").on("load",function(){config.success(b,f)}):e.success(b,f)),0>=i||setTimeout(function(){h.close(f)},1e3*i),"tips"!=e.type&&($.isArray(j)||(j=j?[j]:[]),e.closeBtn&&b.find(d[5]).on("click",function(){var a=e.closefun&&e.closefun(f);a===!1||h.close(f)}),e.maxBtn&&g.bind("click",function(){g.hasClass("revert")?(g.removeClass("revert"),h.restore(f),$(this).attr("title","最大化")):(g.addClass("revert"),h.full(f),$(this).attr("title","还原"))}),j.length>0&&b.find(d[4]+" button").on("click",function(){var c,a=parseInt($(this).attr("jebtn"));0===a?j[0]["callback"]?j[0]["callback"](f,b):h.close(f,b):a>0&&(c=j[a]["callback"]&&j[a]["callback"](f,b),c===!1||h.close(f))}),e.maskClose&&$("#jemask"+f).on("click",function(){h.close(f)}),$(window).resize(function(){$.isArray(k)&&(/^\@/.test(k[0])||/^\@/.test(k[1]))&&b.css({top:"",left:""}),c.setPosition(b)})),e.endfun&&(a.endfun[f]=e.endfun)},g.dragLayer=function(a,c,d,e){var h,f=this,g=!-[1];c=c||a,h=tmpY=0,f.isMoveable=!1,c.css("cursor","move"),e?(f.isShadow=e?1==e||0==e?e:!1:!1,f.isShadow&&(f.opacity=d)):(f.opacity=100,f.isShadow=!1),c.on("mousedown",function(c){var d,e,i,j;return c=c||window.event,d=$("<div/>",{id:"jeBox-moves","class":"jeBox-moves"}),e=a.css("left"),i=a.css("top"),j=$("<div/>",{"class":"movescon"}),g&&1!=c.button||g&&0==c.button?!1:(f.isShadow&&(d.css({width:a.outerWidth()-4,height:a.outerHeight()-4,left:e,top:i,"z-index":parseInt(a.css("z-index"))+10}),$("body").append(d.append(j))),f.isMoveable=!0,h=c.pageX-e.replace(b,""),tmpY=c.pageY-i.replace(b,""),c.preventDefault&&(c.preventDefault(),c.stopPropagation()),$(document).on("mousemove",function(b){if(f.isMoveable){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();var b=b||window.event,c=f.isShadow?d:a,e=b.pageX-h,g=b.pageY-tmpY,i=$(window).width()-a.outerWidth(),j=$(window).height()-a.outerHeight();0>=e&&(e=0),0>=g&&(g=0),e>=i&&(e=i),g>=j&&(g=j),c.css({top:g,left:e})}}).on("mouseup",function(){f.isMoveable&&(f.isMoveable=!1,h=tmpY=0,a.css({right:"",bottom:""}),f.isShadow&&(a.css({top:d.css("top"),left:d.css("left")}),$("#jeBox-moves").remove()),$(window).width()!=a.outerWidth()&&a.attr("offset",[a.css("top").replace(b,""),a.css("left").replace(b,"")]))}),void 0)})},a.backInSitu=function(a,b,c,d,e){b.length>0&&b.parent()?b.after(a):c.length>0&&c.parent()?c.before(a):d.length>0&&d.append(a),a.css("display",e)},h=function(a){var b=new f(a||{});return b.jeidx},h.version="1.6",h.close=function(b){var c=$("#"+d[0]+b),e=$("#jemask"+b),f=c.attr("jenode"),g=["prev"+b,"next"+b,"parent"+b,"dispy"+b];c&&($(f).size()>0&&1===$(f)[0].nodeType&&a.backInSitu($(f),a[g[0]],a[g[1]],a[g[2]],a[g[3]]),c&&c.remove(),e&&e.remove(),"hidden"==$("body").css("overflow")&&$("body").css("overflow",""),$.each(g,function(b,c){delete a[c]}),"function"==typeof a.endfun[b]&&a.endfun[b](),delete a.endfun[b])},h.closeAll=function(a){$.each($(d[1]),function(){var b=$(this),c=a?b.attr("jetype")===a:1;c&&h.close(parseInt(b.attr("jeitem"))),c=null})},h.msg=function(a,b,c){var d=$.isFunction(b);return d&&(c=b),h($.extend({title:!1,content:a,padding:"10px",skinCell:"jeBox-animMsg",time:3,maskLock:!1,closeBtn:!1,end:c},!d&&function(){return b=b||{}}()))},h.alert=function(a,b,c){var d=$.isFunction(b);return d&&(c=b),h($.extend({content:a,button:[{name:"确定",callback:c}]},d?{}:b))},h.loading=function(a,b,c){return h($.extend({title:!1,closeBtn:!1,type:"loading",skinCell:"jeBox-animLoad",maskLock:!1,content:void 0==b?"":b,icon:a||1},c))},h.tips=function(a,b,c){return h($.extend({cell:a,type:"tips",content:void 0==b?"":b,align:"top",boxStyle:{"background-color":"#5eb95e"},spacing:10},c||{}))},h.title=function(a,b){$("#"+d[0]+b).find(d[2]).html(a)},h.content=function(a,b){$("#"+d[0]+b).find(d[3]).html(a)},h.restore=function(b){var c=$("#"+d[0]+b),e=c.find(d[3]),f=c.attr("area").split(/,/g),g=c.attr("offset").split(/,/g);$("body").css("overflow",0==a.scrollbar?"hidden":""),c.css({width:f[0],height:f[1],top:g[0]+"px",left:g[1]+"px",right:"",bottom:""}),e.css({width:f[2],height:f[3]})},h.full=function(a){var b,c=$("#"+d[0]+a),e=c.find(d[3]);$("body").css("overflow","hidden"),clearTimeout(b),b=setTimeout(function(){c.find(d[6]).addClass("revert");var a="fixed"===c.css("position"),b=c.attr("offset").split(","),f=$(window).width(),g=$(window).height(),h=e.outerWidth(!0)-e.width(),i=e.outerHeight(!0)-e.height(),j=c.find(d[2]).outerHeight(!0),k=c.find(d[4]).outerHeight(!0);c.css({width:f,height:g,top:a?0:b[0],left:a?0:b[1],right:"",bottom:""}),e.css({width:f-h,height:g-i-j-k})},50)},h.frameCell=function(a,b){return b=b||$(".jeboxiframe").attr("jeitem"),$("#"+d[0]+b).find("iframe").contents().find(a)},h.frameIndex=function(a){return $("#"+d[0]+a).attr("jeitem")},h.frameUrl=function(a,b){$("#"+d[0]+a).find("iframe").attr("src",b)},h});

<%- layout('layout')%>

<div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-8">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span>主页 / </span>修改密码
                </div>
                <div class="panel-body">
                    <ul class="sign_form">
                        <li>
                            <div class="input-group">
                                <span for="form_name">用户名</span>
                                <input type="text" id="form_name" class="control-group" placeholder="请输入您的用户名">
                            </div>
                        </li>
                        <li>
                            <div class="input-group">
                                <span for="form_psd">旧密码</span>
                                <input type="text" class="control-group" placeholder="" id="oldpsd">
                            </div>
                        </li>
                        <li>
                            <div class="input-group">
                                <span for="form_psd">新密码</span>
                                <input type="text" class="control-group" placeholder="" id="newpsd">
                            </div>
                        </li>
                    </ul>
                    <div class="row" style="display: flex;justify-content: center;margin-bottom: 20px">
                        <button type="button" class="btn btn-primary">登录</button>
                        <button type="button" class="btn btn-link">忘记密码</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs-4 hidden-xs">
            <div class="panel panel-default">
                <div class="panel-heading">
                    关于
                </div>
                <div class="panel-body">
                    这是一个DEMO
                    <br/>
                    <br/>
                    <p>在这里你可以：</p>
                    <ol>
                        <li>&nbsp;&nbsp;1、向别人提出你遇到的问题</li>
                        <li>&nbsp;&nbsp;2、帮助遇到问题的人</li>
                        <li>&nbsp;&nbsp;3、分享自己的知识</li>
                        <li>&nbsp;&nbsp;4、和其它人一起进步</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        var username = '<%= username %>';
        console.log(username);
        $('.btn-primary').on('click',function(){
            var data={
                username:$('#form_name').val(),
                oldpassword:$('#oldpsd').val(),
                newpassword:$('#newpsd').val()
            }
            var flag = true
            for(var k in data){
                if(data[k]==''){
                    flag = false
                }
            }
            /*console.log(data);*/
            if(data.username!=username){
                alert('用户名错误')
                return
            }
            if(flag){
                ajaxrequest('/changepsd','POST',data,function(res){
                    console.log(res);
                    if(res.code==1){
                        alert(res.info[0]);
                        location.reload()
                    }else{
                        alert(res.info[0])
                    }
                },function(res){
                    console.log(res);
                })
            }
        })
    })
</script>